<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PRO - Pakistan Recovery Oasis</title>
    
    <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        /* Print Styles */
        @media print {
            body * { visibility: hidden; }
            #printable-area, #printable-area * { visibility: visible; }
            #printable-area { position: absolute; left: 0; top: 0; width: 100%; background: white; color: black; }
            .no-print { display: none !important; }
            .page-break { page-break-after: always; }
            
            /* Custom Print Layout Styles */
            .print-container { padding: 20px; font-family: 'Times New Roman', serif; }
            .print-header { display: flex; align-items: center; justify-content: center; margin-bottom: 20px; border-bottom: 2px solid #166534; padding-bottom: 10px; gap: 20px; }
            .print-logo-icon { font-size: 40pt; color: #166534; }
            .print-title-block { text-align: left; }
            .print-pro { font-size: 36pt; font-weight: bold; color: #166534; line-height: 1; letter-spacing: 2px; }
            .print-sub-pro { font-size: 14pt; font-weight: bold; color: #333; text-transform: uppercase; letter-spacing: 1px; }
            .print-tagline { font-size: 10pt; color: #555; }

            .print-row { display: flex; margin-bottom: 8px; border-bottom: 1px dotted #ccc; padding-bottom: 2px; }
            .print-label { font-weight: bold; width: 180px; }
            .print-value { flex: 1; }
            
            .print-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
            .print-table th, .print-table td { border: 1px solid black; padding: 5px; text-align: left; font-size: 10pt; }
            
            .urdu-text { font-family: 'Noto Nastaliq Urdu', 'Arial', sans-serif; direction: rtl; text-align: right; line-height: 1.8; }
            .urdu-row { margin-bottom: 15px; }
            .box-section { border: 1px solid black; padding: 10px; margin-top: 20px; border-radius: 5px; }
        }
        
        #printable-area { display: none; }
        @media print { #printable-area { display: block; } }
    </style>

    <script>
        let patientsData = [];
        let currentPatientId = null;
        let admissionChart = null;

        async function initApp() { await fetchPatients(); }

        async function fetchPatients() {
            try {
                const res = await fetch('/api/patients');
                if(!res.ok) throw new Error("Failed to fetch data");
                patientsData = await res.json();
                updateDashboard();
                renderPatientsTable(patientsData);
                if(currentPatientId) {
                    const p = patientsData.find(x => (x._id || x.id) === currentPatientId);
                    if(p) loadPatientData(p);
                }
            } catch(e) { console.error("Error:", e); }
        }

        function updateDashboard() {
            document.getElementById('dash-total').innerText = patientsData.length;
            const today = new Date().toISOString().split('T')[0];
            const admittedToday = patientsData.filter(p => p.admissionDate === today).length;
            document.getElementById('dash-today').innerText = admittedToday;

            const ctx = document.getElementById('admissionChart');
            if(ctx) {
                const labels = [], data = [];
                for(let i=4; i>=0; i--) {
                    const d = new Date(); d.setDate(d.getDate() - i);
                    const dateStr = d.toISOString().split('T')[0];
                    labels.push(d.toLocaleDateString('en-US', {weekday: 'short'}));
                    data.push(patientsData.filter(p => p.admissionDate === dateStr).length);
                }
                if (admissionChart) admissionChart.destroy();
                admissionChart = new Chart(ctx, {
                    type: 'bar',
                    data: { labels: labels, datasets: [{ label: 'Admissions', data: data, backgroundColor: '#16a34a', borderRadius: 6 }] },
                    options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { y: { beginAtZero: true, ticks: { stepSize: 1 } } } }
                });
            }
        }

        window.navigateTo = function(viewId) {
            document.querySelectorAll('.view-section').forEach(el => el.classList.add('hidden'));
            document.getElementById(viewId).classList.remove('hidden');
            document.querySelectorAll('.nav-item').forEach(el => { el.classList.remove('bg-green-800', 'text-white'); el.classList.add('text-green-100'); });
            const navId = viewId === 'dashboard-view' ? 'nav-dash' : 'nav-patients';
            const navEl = document.getElementById(navId);
            if(navEl) { navEl.classList.remove('text-green-100'); navEl.classList.add('bg-green-800', 'text-white'); }
            if(viewId === 'dashboard-view') updateDashboard();
        };

        function renderPatientsTable(list) {
            const tbody = document.getElementById('patients-table-body');
            tbody.innerHTML = '';
            if(list.length === 0) { tbody.innerHTML = '<tr><td colspan="5" class="p-6 text-center text-gray-400">No records found.</td></tr>'; return; }
            list.forEach(p => {
                const id = p._id || p.id;
                const tr = document.createElement('tr');
                tr.className = "hover:bg-gray-50 border-b cursor-pointer transition";
                tr.onclick = (e) => { if(e.target.closest('.action-btn')) return; showPatientDetail(id); };
                tr.innerHTML = `<td class="px-6 py-4 font-medium">${p.name}</td><td class="px-6 py-4 text-gray-500">${p.idNo||'-'}</td><td class="px-6 py-4 text-gray-500">${p.contactNo||'-'}</td><td class="px-6 py-4"><span class="px-2 py-1 text-xs rounded-full bg-green-100 text-green-800">Admitted</span></td><td class="px-6 py-4 text-right"><button class="action-btn text-red-400 hover:text-red-600 p-2" onclick="window.deletePatient('${id}')"><i class="fas fa-trash"></i></button></td>`;
                tbody.appendChild(tr);
            });
        }

        window.showPatientDetail = function(id) {
            currentPatientId = id;
            const p = patientsData.find(x => (x._id || x.id) === id);
            if (!p) return;
            loadPatientData(p);
            populatePrintTemplate(p);
            navigateTo('patient-detail-view');
        };

        function loadPatientData(p) {
            const setVal = (id, val) => { const el = document.getElementById(id); if(el) el.value = val || ''; };
            setVal('det-name', p.name); setVal('det-father', p.fatherName); setVal('det-admission', p.admissionDate);
            setVal('det-id', p.idNo); setVal('det-age', p.age); setVal('det-cnic', p.cnic);
            setVal('det-contact', p.contactNo); setVal('det-marital', p.maritalStatus || 'Married');
            setVal('det-guardian', p.guardianName); setVal('det-relation', p.relation);
            setVal('det-address', p.address); setVal('det-complaint', p.complaint);
            setVal('det-drug', p.drugProblem); setVal('det-prev', p.prevAdmissions);

            const notesList = document.getElementById('notes-list');
            notesList.innerHTML = '';
            (p.notes || []).sort((a,b) => new Date(b.date) - new Date(a.date)).forEach(note => {
                notesList.innerHTML += `<div class="flex gap-4 pb-4 border-b border-gray-100 mb-2"><div class="text-xs text-gray-500 w-24">${new Date(note.date).toLocaleDateString()}</div><div class="text-sm text-gray-800">${note.text}</div></div>`;
            });
        }
        
        function populatePrintTemplate(p) {
            document.getElementById('pr-name').textContent = p.name || '';
            document.getElementById('pr-father').textContent = p.fatherName || '';
            document.getElementById('pr-admission').textContent = p.admissionDate || '';
            document.getElementById('pr-id').textContent = p.idNo || '';
            document.getElementById('pr-age').textContent = p.age || '';
            document.getElementById('pr-cnic').textContent = p.cnic || '';
            document.getElementById('pr-guardian').textContent = p.guardianName || '';
            document.getElementById('pr-relation').textContent = p.relation || '';
            document.getElementById('pr-drug').textContent = p.drugProblem || '';
            document.getElementById('pr-contact').textContent = p.contactNo || '';
            document.getElementById('pr-marital').textContent = p.maritalStatus || '';
            document.getElementById('pr-prev').textContent = p.prevAdmissions || '';
            document.getElementById('pr-address').textContent = p.address || '';
            document.getElementById('pr-complaint').textContent = p.complaint || '';
            
            document.getElementById('ur-name').textContent = p.name || '................';
            document.getElementById('ur-father').textContent = p.fatherName || '................';
            document.getElementById('ur-age').textContent = p.age || '................';
            document.getElementById('ur-cnic').textContent = p.cnic || '................';
            document.getElementById('ur-contact').textContent = p.contactNo || '................';
            document.getElementById('ur-address').textContent = p.address || '................';
            document.getElementById('ur-auth-name').textContent = p.guardianName || '................';
        }

        window.savePatientDetails = async function(e) {
            e.preventDefault();
            const data = {};
            ['name','father','admission','id','age','cnic','contact','marital','guardian','relation','address','complaint','drug','prev'].forEach(k => {
                const el = document.getElementById('det-'+k);
                if(el) data[k==='admission'?'admissionDate':k==='id'?'idNo':k==='father'?'fatherName':k==='contact'?'contactNo':k==='guardian'?'guardianName':k==='drug'?'drugProblem':k==='prev'?'prevAdmissions':k==='marital'?'maritalStatus':k+'Name' in data ? k : k] = el.value;
                if(k=='name') data.name=el.value; if(k=='father') data.fatherName=el.value;
                if(k=='admission') data.admissionDate=el.value; if(k=='id') data.idNo=el.value;
                if(k=='age') data.age=el.value; if(k=='cnic') data.cnic=el.value;
                if(k=='contact') data.contactNo=el.value; if(k=='marital') data.maritalStatus=el.value;
                if(k=='guardian') data.guardianName=el.value; if(k=='relation') data.relation=el.value;
                if(k=='address') data.address=el.value; if(k=='complaint') data.complaint=el.value;
                if(k=='drug') data.drugProblem=el.value; if(k=='prev') data.prevAdmissions=el.value;
            });

            await fetch(`/api/patients/${currentPatientId}`, { method: 'PUT', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(data) });
            alert("Saved"); fetchPatients();
        };

        window.addNote = async function() {
            const txt = document.getElementById('new-note-input').value;
            if(!txt) return;
            await fetch(`/api/patients/${currentPatientId}/notes`, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({text:txt, date:new Date().toISOString()}) });
            document.getElementById('new-note-input').value=''; fetchPatients(); showPatientDetail(currentPatientId);
        };
        
        window.addNewPatient = async function() {
            const n = prompt("Patient Name:");
            if(n) { await fetch('/api/patients', { method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({name:n, admissionDate:new Date().toISOString().split('T')[0]}) }); fetchPatients(); }
        };
        
        window.deletePatient = async function(id) {
            if(confirm("Delete?")) { await fetch(`/api/patients/${id}`, {method:'DELETE'}); fetchPatients(); }
        };

        window.openExportModal = () => document.getElementById('export-modal').classList.remove('hidden');
        window.closeExportModal = () => document.getElementById('export-modal').classList.add('hidden');
        window.downloadExcel = async function() {
             const mode = document.querySelector('input[name="export-mode"]:checked').value;
             const res = await fetch('/api/export', { method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify({fields: mode==='all'?'all':[]}) });
             const blob = await res.blob();
             const url = window.URL.createObjectURL(blob);
             const a = document.createElement('a'); a.href = url; a.download = "patients.xlsx"; document.body.appendChild(a); a.click(); a.remove();
             closeExportModal();
        }

        window.onload = initApp;
    </script>
</head>
<body class="bg-gray-50 h-screen flex overflow-hidden font-sans text-gray-800">

    <!-- Sidebar -->
    <aside class="w-64 bg-green-900 text-white flex-none flex flex-col no-print shadow-xl z-20">
        <div class="p-6 border-b border-green-800">
            <h1 class="text-2xl font-bold flex items-center gap-2">
                <i class="fas fa-brain text-green-400"></i>
                PRO System
            </h1>
            <p class="text-xs text-green-300 mt-1 pl-8">Pakistan Recovery Oasis</p>
        </div>
        <nav class="flex-1 p-4 space-y-2">
            <button id="nav-dash" onclick="window.navigateTo('dashboard-view')" class="nav-item w-full text-left px-4 py-3 rounded-lg bg-green-800 text-white hover:bg-green-700">Dashboard</button>
            <button id="nav-patients" onclick="window.navigateTo('patients-view')" class="nav-item w-full text-left px-4 py-3 rounded-lg text-green-100 hover:bg-green-800">Patients Directory</button>
        </nav>
    </aside>

    <main class="flex-1 overflow-auto relative">
        <!-- Dashboard -->
        <section id="dashboard-view" class="view-section p-8">
            <h2 class="text-2xl font-bold mb-6">Overview</h2>
            <div class="grid grid-cols-3 gap-6 mb-8">
                <div class="bg-white p-6 rounded shadow"><h3>Total Patients</h3><p class="text-3xl font-bold" id="dash-total">0</p></div>
                <div class="bg-white p-6 rounded shadow"><h3>Admitted Today</h3><p class="text-3xl font-bold" id="dash-today">0</p></div>
                <div class="bg-white p-6 rounded shadow"><h3>Critical Alerts</h3><p class="text-3xl font-bold">0</p></div>
            </div>
            <div class="bg-white p-6 rounded shadow h-[600px]"><canvas id="admissionChart"></canvas></div>
        </section>

        <!-- Directory -->
        <section id="patients-view" class="view-section hidden p-8">
            <div class="flex justify-between mb-6">
                <h2 class="text-2xl font-bold">Patients Directory</h2>
                <div class="flex gap-2">
                    <button onclick="openExportModal()" class="bg-green-600 text-white px-4 py-2 rounded">Export Excel</button>
                    <button onclick="addNewPatient()" class="bg-green-600 text-white px-4 py-2 rounded">New Admission</button>
                </div>
            </div>
            <div class="bg-white rounded shadow"><table class="min-w-full"><tbody id="patients-table-body"></tbody></table></div>
        </section>

        <!-- Detail View -->
        <section id="patient-detail-view" class="view-section hidden p-8">
            <div class="flex justify-between mb-4 no-print">
                <button onclick="navigateTo('patients-view')" class="text-gray-500">Back</button>
                <div class="flex gap-2">
                    <button onclick="window.print()" class="bg-white border px-4 py-2 rounded">Print Profile</button>
                    <button onclick="document.getElementById('save-det-btn').click()" class="bg-green-600 text-white px-4 py-2 rounded">Update Record</button>
                </div>
            </div>
            <div class="grid grid-cols-3 gap-8">
                <div class="col-span-2 bg-white p-6 rounded shadow">
                    <form onsubmit="savePatientDetails(event)">
                        <input type="submit" id="save-det-btn" class="hidden">
                        <div class="grid grid-cols-2 gap-4">
                            <input id="det-name" class="border p-2" placeholder="Name">
                            <input id="det-father" class="border p-2" placeholder="Father Name">
                            <input id="det-admission" type="date" class="border p-2">
                            <input id="det-id" class="border p-2" placeholder="ID">
                            <input id="det-age" class="border p-2" placeholder="Age">
                            <input id="det-cnic" class="border p-2" placeholder="CNIC">
                            <input id="det-contact" class="border p-2" placeholder="Contact">
                            <select id="det-marital" class="border p-2 bg-white"><option>Married</option><option>Unmarried</option><option>Divorced</option></select>
                            <input id="det-guardian" class="border p-2" placeholder="Guardian">
                            <input id="det-relation" class="border p-2" placeholder="Relation">
                            <div class="col-span-2"><input id="det-address" class="border p-2 w-full" placeholder="Address"></div>
                            <div class="col-span-2"><textarea id="det-complaint" class="border p-2 w-full" placeholder="Complaint"></textarea></div>
                            <input id="det-drug" class="border p-2" placeholder="Drug Problem">
                            <input id="det-prev" class="border p-2" placeholder="Prev Admissions">
                        </div>
                    </form>
                </div>
                <div class="bg-white p-6 rounded shadow h-[600px] flex flex-col">
                    <h4 class="font-bold mb-4">Clinical Notes</h4>
                    <div id="notes-list" class="flex-1 overflow-y-auto mb-4"></div>
                    <div><input id="new-note-input" class="border w-full p-2 mb-2"><button onclick="addNote()" class="bg-gray-100 w-full py-2">Add Note</button></div>
                </div>
            </div>
        </section>
    </main>

    <!-- EXPORT MODAL -->
    <div id="export-modal" class="fixed inset-0 bg-gray-900 bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white p-6 rounded shadow-xl w-96">
            <h3 class="font-bold text-lg mb-4">Export</h3>
            <label class="block mb-2"><input type="radio" name="export-mode" value="all" checked> All Fields</label>
            <button onclick="downloadExcel()" class="bg-green-600 text-white w-full py-2 rounded mt-4">Download</button>
            <button onclick="closeExportModal()" class="w-full py-2 mt-2 text-gray-500">Cancel</button>
        </div>
    </div>

    <!-- PRINT TEMPLATE -->
    <div id="printable-area">
        <div class="print-container">
            <!-- RECREATED LOGO HEADER -->
            <div class="print-header">
                <i class="fas fa-brain print-logo-icon"></i>
                <div class="print-title-block">
                    <div class="print-pro">PRO</div>
                    <div class="print-sub-pro">PAKISTAN RECOVERY OASIS</div>
                    <div class="print-tagline">Addiction Treatment & Psychological Services</div>
                </div>
            </div>
            
            <div class="grid grid-cols-2 gap-x-8 text-sm">
                <div class="print-row"><span class="print-label">Patient's Name:</span> <span id="pr-name" class="print-value"></span></div>
                <div class="print-row"><span class="print-label">Father's Name:</span> <span id="pr-father" class="print-value"></span></div>
                
                <div class="print-row"><span class="print-label">Date of Admission:</span> <span id="pr-admission" class="print-value"></span></div>
                <div class="print-row"><span class="print-label">I.D. No.:</span> <span id="pr-id" class="print-value"></span></div>
                
                <div class="print-row"><span class="print-label">Age:</span> <span id="pr-age" class="print-value"></span></div>
                <div class="print-row"><span class="print-label">CNIC No.:</span> <span id="pr-cnic" class="print-value"></span></div>
                
                <div class="print-row"><span class="print-label">Guardian Name:</span> <span id="pr-guardian" class="print-value"></span></div>
                <div class="print-row"><span class="print-label">Relation:</span> <span id="pr-relation" class="print-value"></span></div>
                
                <div class="print-row"><span class="print-label">Drug of Problem:</span> <span id="pr-drug" class="print-value"></span></div>
                <div class="print-row"><span class="print-label">Contact No:</span> <span id="pr-contact" class="print-value"></span></div>
                
                <div class="print-row"><span class="print-label">Marital Status:</span> <span id="pr-marital" class="print-value"></span></div>
                <div class="print-row"><span class="print-label">Prev Admissions:</span> <span id="pr-prev" class="print-value"></span></div>
            </div>
            
            <div class="print-row mt-4"><span class="print-label w-24">Address:</span> <span id="pr-address" class="print-value"></span></div>
            <div class="print-row"><span class="print-label w-32">Presenting Complaint:</span> <span id="pr-complaint" class="print-value"></span></div>

            <div class="mt-6 border border-black h-32 p-2">
                <strong>History:</strong>
            </div>
            <div class="mt-4 border border-black h-32 p-2">
                <strong>General Physical Examination:</strong>
            </div>

            <div class="mt-6">
                <strong>Systematic examination / Vital Signs</strong>
                <table class="print-table">
                    <tr><th>Resp</th><td></td> <th>BP</th><td></td></tr>
                    <tr><th>GIT</th><td></td> <th>Pulse</th><td></td></tr>
                    <tr><th>CVS</th><td></td> <th>Temp</th><td></td></tr>
                    <tr><th>CNS</th><td></td> <th>R/R</th><td></td></tr>
                    <tr><th>BSR</th><td></td> <th>Weight</th><td></td></tr>
                </table>
            </div>
        </div>
        
        <div class="page-break"></div>

        <!-- Page 2: DAST-10 -->
        <div class="print-container">
            <h2 class="text-xl font-bold text-center mb-4">Drug Abuse Screening Test, DAST-10</h2>
            <p class="text-sm italic mb-4">The following questions concern information about your possible involvement with drugs not including alcoholic beverages during the past 12 months.</p>
            
            <table class="print-table">
                <thead>
                    <tr class="bg-gray-100">
                        <th class="w-12 text-center">#</th>
                        <th>In the past 12 months...</th>
                        <th class="w-12 text-center">Yes</th>
                        <th class="w-12 text-center">No</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>1</td><td>Have you used drugs other than those required for medical reasons?</td><td></td><td></td></tr>
                    <tr><td>2</td><td>Do you abuse more than one drug at a time?</td><td></td><td></td></tr>
                    <tr><td>3</td><td>Are you unable to stop abusing drugs when you want to?</td><td></td><td></td></tr>
                    <tr><td>4</td><td>Have you ever had blackouts or flashbacks as a result of drug use?</td><td></td><td></td></tr>
                    <tr><td>5</td><td>Do you ever feel bad or guilty about your drug use?</td><td></td><td></td></tr>
                    <tr><td>6</td><td>Does your spouse (or parents) ever complain about your involvement with drugs?</td><td></td><td></td></tr>
                    <tr><td>7</td><td>Have you neglected your family because of your use of drugs?</td><td></td><td></td></tr>
                    <tr><td>8</td><td>Have you engaged in illegal activities in order to obtain drugs?</td><td></td><td></td></tr>
                    <tr><td>9</td><td>Have you ever experienced withdrawal symptoms (felt sick) when you stopped?</td><td></td><td></td></tr>
                    <tr><td>10</td><td>Have you had medical problems as a result of your drug use?</td><td></td><td></td></tr>
                </tbody>
            </table>
            
            <div class="mt-6 border p-4 text-center">
                <strong>Scoring:</strong> Score 1 point for each "Yes", except for question 3 for which "No" receives 1 point.
                <br><strong>Total Score: ________</strong>
            </div>
        </div>

        <div class="page-break"></div>

        <!-- Page 3: Order Form & Consent -->
        <div class="print-container">
            <h2 class="text-xl font-bold text-center underline mb-6">PATIENT ORDER FORM</h2>
            <div class="print-row"><span class="print-label">Presenting Complaints:</span></div>
            <div class="print-row mt-4"><span class="print-label">Psychological:</span></div>
            <div class="print-row mt-4"><span class="print-label">Biological:</span></div>
            <div class="print-row mt-4"><span class="print-label">Social:</span></div>
            <div class="print-row mt-4"><span class="print-label">Diagnosis:</span></div>
            <div class="print-row mt-4"><span class="print-label">Recommendation:</span></div>
            
            <div class="mt-12 text-right">
                <p>__________________________</p>
                <p>Doctor's Name, Signature & Stamp</p>
            </div>

            <div class="mt-12 pt-6 border-t-2 border-black">
                <h2 class="text-center font-bold text-2xl mb-4">Consent Form / اجازت نامہ</h2>
                
                <div class="urdu-text text-right text-lg">
                    <p class="urdu-row">
                        مریض کا نام: <span id="ur-name" class="underline font-bold px-2"></span> 
                        ولدیت: <span id="ur-father" class="underline font-bold px-2"></span> 
                        عمر: <span id="ur-age" class="underline font-bold px-2"></span>
                    </p>
                    <p class="urdu-row">
                        شناختی کارڈ: <span id="ur-cnic" class="underline font-bold px-2"></span> 
                        رابطہ نمبر: <span id="ur-contact" class="underline font-bold px-2"></span> 
                        پتہ: <span id="ur-address" class="underline font-bold px-2"></span>
                    </p>
                    
                    <p class="mb-4 text-justify">
                        میں اس بات کی تصدیق کرتا/کرتی ہوں کہ مجھے نشے کی بیماری، اس کے اثرات، علاج کے تمام مراحل، فوائد، ممکنہ مشکلات، اور ممکنہ نتائج کے بارے میں تفصیل سے آگاہ کر دیا گیا ہے۔ میں اس بات کو بھی سمجھتا/سمجھتی ہوں کہ علاج کے دوران کسی بھی قسم کی طبی اور نفسیاتی پیچیدگیاں پیدا ہوسکتی ہیں، اور میں ان سے مکمل طور پر باخبر ہوں۔
                    </p>
                    <p class="mb-4 text-justify">
                        میں اپنی مرضی اور مکمل ہوش و حواس میں "پاکستان ریکوری اویسس" میں علاج کے لیے داخل ہو رہا/رہی ہوں۔ میں ادارے کے تمام قواعد و ضوابط، طریقہ علاج، اور تربیتی اصولوں سے متفق ہوں اور ان پر عمل کرنے کا پابند ہوں۔
                    </p>
                    <p class="mb-8">
                        یا میں "پاکستان ریکوری اویسس" کے تمام قواعد و ضوابط اور طریقہ علاج سے متفق ہوں اور اپنی مرضی سے داخل ہو رہا ہوں۔
                    </p>
                    
                    <div class="flex justify-between mt-12 px-8">
                        <div class="text-center">
                            <p>__________________</p>
                            <p>مریض کے دستخط</p>
                        </div>
                        <div class="text-center">
                            <p>__________________</p>
                            <p>والد/سرپرست کے دستخط</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="page-break"></div>
        
        <!-- Page 4: Rules & Authority (Urdu) -->
        <div class="print-container">
            <h1 class="text-center text-3xl font-bold mb-2">پاکستان ریکوری اویسس</h1>
            <h2 class="text-center text-xl mb-6">قواعد و ضوابط / اقرار نامہ</h2>
            
            <div class="urdu-text text-right text-lg list-disc pr-4 space-y-2">
                <p>٭ سرپرست کی اجازت کے بغیر کسی سے مریض کی ملاقات نہیں کروائی جائے گی۔</p>
                <p>٭ مریض سے پہلی ملاقات ایک ماہ کے بعد کروائی جائے گی۔</p>
                <p>٭ علاج کی مدت __________________ ہے اور مقررہ معیاد سے قبل چھٹی نہیں ہو سکے گی۔</p>
                <p>٭ مریض کے پاس ٹیلیفون کی سہولت نہیں ہوگی تاہم آپ کا کوئی ضروری پیغام مریض تک پہنچا دیا جائے گا۔</p>
                <p>٭ کلینک کے باہر سے اشیاء منگوانے میں کلینک پابند نہیں ہوگا۔</p>
                <p>٭ کلینک میں مریضوں کے ساتھ شائستہ رویہ اختیار کیا جاتا ہے۔ ادارہ حتی الوسع مریضوں کی نگہداشت کرتا ہے۔ تاہم اگر کوئی مریض نشے کی طلب یا مایوسی کی بناء پر اپنی ذات کو کوئی نقصان پہنچاتا ہے تو اس کی ذمہ داری مریض پر ہی عائد ہوتی ہے۔</p>
                <p>٭ مریض کے لواحقین کا فرض ہے کہ وہ ادارہ سے تعاون فرمائیں۔ اس طریقہ علاج پر وسیع معلومات حاصل کریں۔ اس طرح وہ مریض کے علاج میں تعاون کر سکتے ہیں۔</p>
                <p>٭ ماہانہ فیس پیشگی ادا کی جائے گی۔</p>
            </div>
            
            <div class="box-section mt-8">
                <h3 class="text-center font-bold text-2xl mb-4 border-b pb-2">جس سے بھی متعلق ہو</h3>
                <div class="urdu-text text-right text-lg space-y-3">
                    <p>حاملین رقعہ ہذا ہمارے سٹاف ممبران ہیں۔ یہ ایک نفسیاتی مریض کو گھر سے لینے جا رہے ہیں جو کہ نشے کا عادی بھی ہے۔ واپسی پر انکے ہمراہ ہو گا۔</p>
                    <p>اس کے لیے مریض کے گھر والوں کی جانب سے درخواست کی گئی ہے جیسا کہ اندیشہ رہتا ہے کہ کوئی بھی ایسا مریض نقص امن کا موجب بن سکتا ہے۔</p>
                    <p>ایسی کسی بھی صورت میں ہر خاص و عام سے تعاون کی اپیل کی جاتی ہے۔ شکریہ</p>
                    
                    <div class="mt-4 border-t pt-4">
                        <p>بحیثیت سرپرست اپنے مریض مسمی ______________________ ولد/زوجہ ______________________</p>
                        <p>کو بغرض علاج پاکستان ریکوری اویسس لاہور بھجوا رہا ہوں۔ مجھے کلینک کے قواعد و ضوابط سے آگاہ کر دیا ہے اور مجھے اس سے مکمل اتفاق ہے۔</p>
                    </div>
                    
                    <div class="mt-6">
                        <p>دستخط سرپرست: ______________________ (<span id="ur-auth-name"></span>)</p>
                        <p>شناختی کارڈ نمبر: ______________________</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="page-break"></div>

        <!-- Page 5: Payment Record -->
        <div class="print-container">
            <h2 class="text-xl font-bold text-center mb-4">Patient's Payment Record</h2>
            <table class="print-table">
                <thead><tr><th>Date</th><th>Amount Received</th><th>Signature</th></tr></thead>
                <tbody>
                    <tr class="h-10"><td></td><td></td><td></td></tr>
                    <tr class="h-10"><td></td><td></td><td></td></tr>
                    <tr class="h-10"><td></td><td></td><td></td></tr>
                    <tr class="h-10"><td></td><td></td><td></td></tr>
                    <tr class="h-10"><td></td><td></td><td></td></tr>
                    <tr class="h-10"><td></td><td></td><td></td></tr>
                    <tr class="h-10"><td></td><td></td><td></td></tr>
                    <tr class="h-10"><td></td><td></td><td></td></tr>
                </tbody>
            </table>
            
            <div class="grid grid-cols-2 gap-4 mt-8 font-bold">
                <div>Charges: _________________</div>
                <div>Canteen: _________________</div>
                <div>Laundry: _________________</div>
                <div>Barber: __________________</div>
                <div>Test: ____________________</div>
                <div>Medicine: ________________</div>
            </div>

            <h2 class="text-xl font-bold text-center mt-12 mb-4">Consultant Psychiatrist Visit</h2>
            <table class="print-table">
                <thead><tr><th>Date</th><th>Medication / Notes</th></tr></thead>
                <tbody>
                    <tr class="h-12"><td></td><td></td></tr>
                    <tr class="h-12"><td></td><td></td></tr>
                    <tr class="h-12"><td></td><td></td></tr>
                    <tr class="h-12"><td></td><td></td></tr>
                    <tr class="h-12"><td></td><td></td></tr>
                    <tr class="h-12"><td></td><td></td></tr>
                </tbody>
            </table>
        </div>
    </div>
</body>
</html>
